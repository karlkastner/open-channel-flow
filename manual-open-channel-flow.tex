\documentclass[11pt,twoside,a4paper]{article}
%{book}

% This is an automatically generated file.
% Do not edit it.
% Changes to this file are not preserved!

\usepackage{tocloft}
\usepackage{hyperref}
\usepackage{listings}
\lstset{
basicstyle=\small\ttfamily,
columns=flexible,
breaklines=true
}
\setlength{\cftsubsecnumwidth}{3.5em}

\title{Manual for Package:
open-channel-flow\protect\\Revision 1:9M
}
\author{Karl K\"astner}
%\date{}

\begin{document}

\maketitle

\tableofcontents

% licence
% abstract


\section{@Backwater1D}
\subsection{Backwater1D}
${}$
\begin{lstlisting}
 solve the gradually varied flow equation (backwater equation)
 in one dimension

 c.f. Chow, Bresse

\end{lstlisting}
\subsection{backwater\_approximation}
${}$
\begin{lstlisting}
 approximation of the backwater curve by an exponential function
 note: this is not necessarily a good approximation
 in the case of tide, Qt can be given

\end{lstlisting}
\subsection{backwater\_curve\_iterative}
${}$
\begin{lstlisting}

 analytic solution of the gradually varied flow equation
 c.f. Bresse, Chow

\end{lstlisting}
\subsection{backwater\_length}
${}$
\begin{lstlisting}
 backwater length

\end{lstlisting}
\subsection{dh\_dx}
${}$
\begin{lstlisting}
 change of depth along channel for the backwater equation
 beta : momentum coefficient
 this is effectively an equation in h^3

\end{lstlisting}
\subsection{dh\_dx\_}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{dzs\_dx}
${}$
\begin{lstlisting}
 change of surface elevation along channel

\end{lstlisting}
\subsection{gvf\_x\_chow}
${}$
\begin{lstlisting}
 analytical solution to the gradually varied flow equation (backwater equation)
 c.f. Chow, Bresse

\end{lstlisting}
\subsection{invert}
${}$
\begin{lstlisting}
 determine bed level from surface elevation
 (inverse backwater equation)
 this is ill conditioned, as the surface is smooth for subcritical flow,
 even if the bed is not smoth 

 C : chezy
 W : width
 Q : discharge
 S : bed slope
 y0 : surface elevation at outflow
 lateral inflow

\end{lstlisting}
\subsection{solve}
${}$
\begin{lstlisting}
 solve the gradually varied flow equation (backwater equation)
 C : chezy
 W : width
 Q : discharge
 S : bed slope
 y0 : surface elevation at outflow

\end{lstlisting}
\subsection{solve\_analytic}
${}$
\begin{lstlisting}
 analytical solution to the gradually varied flow equation (bresse method)
u_.^(n-m)./(1-u_.^n)

\end{lstlisting}
\subsection{solve\_matrix}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{@Compound\_Cross\_Section}
\subsection{Compound\_Cross\_Section}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{area}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{discharge}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{roughness}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{@Cross\_Section}
\subsection{Cross\_Section}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{average\_across\_section}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{compute\_discharge}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{compute\_sediment\_transport}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{expand}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{fit\_bed\_level}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{flat}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{grain\_size}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{init}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{invalidate}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{parse\_arguments}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{wetted\_cross\_section}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{wetted\_width}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{bifurcations-and-weirs/@Lateral\_Diversion\_Finite\_Width}
\subsection{Jb}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{Lateral\_Diversion\_Finite\_Width}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{dR}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{derive}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{evalk}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{lateral\_outflow\_finite\_width1}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{load\_functions}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{stagnation\_point}
${}$
\begin{lstlisting}
	fdx    = isnan(x);

\end{lstlisting}
\subsection{streamline}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{u\_far}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{v\_far}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{velocity}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{velocity\_near\_bed}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{bifurcations-and-weirs/@Lateral\_Diversion\_Finite\_Width\_Gradual}
\subsection{Jb}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{Lateral\_Diversion\_Finite\_Width\_Gradual}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{coefficients}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{condA}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{dR}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{derive}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{evalk}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{evalk\_}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{lateral\_outflow\_finite\_width1}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{load\_functions}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{bifurcations-and-weirs/@Lateral\_Diversion\_Finite\_Width\_Gradual/old}
\subsection{coefficients\_old}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{bifurcations-and-weirs/@Lateral\_Diversion\_Finite\_Width\_Gradual}
\subsection{stagnation\_point}
${}$
\begin{lstlisting}
	fdx    = isnan(x);

\end{lstlisting}
\subsection{streamline}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{streamline\_radius\_of\_curvature}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{u\_far}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{uv1}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{uv\_side\_branch}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{v\_far}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{velocity}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{velocity\_linear}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{velocity\_near\_bed}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{xp}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{bifurcations-and-weirs/@Lateral\_Diversion\_Wide\_Channel}
\subsection{Lateral\_Diversion\_Wide\_Channel}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{derive\_lateral\_outflow}
${}$
\begin{lstlisting}
 derive potential flow solution to lateral outlfow from an infinitely
 wide main channel

\end{lstlisting}
\subsection{derive\_lateral\_outflow\_finite\_width}
${}$
\begin{lstlisting}

 derive coefficients for lateral outflow in the case of potential flow


\end{lstlisting}
\subsection{load\_functions}
${}$
\begin{lstlisting}
 load analytical solutions for potential flow field at a lateral diversion
 with an infinitely wide main channel

\end{lstlisting}
\subsection{stagnation\_point}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{streamline\_radius\_of\_curvature}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{bifurcations-and-weirs/@Lateral\_Diversion\_Wide\_Channel\_Map}
\subsection{Lateral\_Diversion\_Wide\_Channel\_Map}
${}$
\begin{lstlisting}

 wrapper to store precomputed streamlines of potential flows


\end{lstlisting}
\subsection{streamline}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{bifurcations-and-weirs/@Side\_Weir}
\subsection{Side\_Weir}
${}$
\begin{lstlisting}
 side weir, analytical solution to (critical) lateral outflow

\end{lstlisting}
\subsection{dzs\_dx}
${}$
\begin{lstlisting}
 side weir, along channel surface gradient

\end{lstlisting}
\subsection{surface\_elevation}
${}$
\begin{lstlisting}
 along-channel surface elevation for (critical) lateral outflow over a side-weir

\end{lstlisting}
\section{bifurcations-and-weirs}
\subsection{Lateral\_Diversion\_Finite\_Width\_Map}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{bifurcations-and-weirs/bifurcation-empirical}
\subsection{bifurcation\_potential\_flow\_dividing\_streamline\_radius}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{sediment\_division\_herrero}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{sediment\_division\_meijer\_ksiazek\_1}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{sediment\_division\_meijer\_ksiazek\_2}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{sediment\_division\_raudkivi}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{sediment\_division\_van\_der\_mark}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{sediment\_division\_wang}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{open-channel-flow}
\begin{lstlisting}
functions for open channel flow, sub modules:

@Backwater1D
	gradually varied flow in 1D (backwater)
@Potential_Flow
	depth averaged potential flow, numerical solution
@Potential_Flow_Analytic
	depth averaged potential flow, analytical solution
rating-curve
	empirical rating curves
@Side_Weir
	analytical solution to lateral outflow over a side weir
@SWE
	dynamical solution of the shallow water equation (saint-venant-equation)
	in 1D
@SWE_2d
	dynamical solution of the shallow water equation (saint-venant-equation)
	in 2D
velocity-profile
	vertical and transverse velocity profiles of the streamwise velocity


\end{lstlisting}
\subsection{boundary\_layer\_height}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{discharge2stage}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{eddy\_viscosity\_depth\_averaged}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{hfilter}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{kinematik-and-diffusion-wave}
\subsection{diffusion\_wave}
${}$
\begin{lstlisting}
 propagation of a diffusion wave (flood wave), c.f. ponce
 advection
 diffusion
 where is the bed slope?
 friction slope
 eddy slope
 chow 1988
 d(A+A0)/dt + dQ/dx = q
 dQ/dt + d/dx betaQ^2/A + gA(dh/dx + Sf + Se) - beta q_i v_i + Wf B = 0
 A0 ignored
 inflow and wind shear ignored

\end{lstlisting}
\subsection{flood\_wave\_diffusion\_coefficient}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{linear\_wave}
${}$
\begin{lstlisting}
 linear wave routing (linearised kinematic wave)

\end{lstlisting}
\section{meander-bend/@Equilibrium\_Bend}
\subsection{Equilibrium\_Bend}
${}$
\begin{lstlisting}
 Transverse profile of the bed level and bed material grain size in
 an equilibrium (infintely long) meander bend

\end{lstlisting}
\subsection{bed\_profile}
${}$
\begin{lstlisting}
 predict transverse bed profile of an equilibrium meander bend

\end{lstlisting}
\subsection{bed\_profile\_uniform}
${}$
\begin{lstlisting}
 transverse profile of the bed level of an equilibrium meander bend
 with uniform grain size

\end{lstlisting}
\subsection{calibrate}
${}$
\begin{lstlisting}
 calibrate bend geometry to given profile

\end{lstlisting}
\subsection{dD\_dr}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{dh\_dr}
${}$
\begin{lstlisting}
 across channel derivative of flow depth for a meandering river

\end{lstlisting}
\subsection{dh\_dr\_uniform}
${}$
\begin{lstlisting}
 transverse gradient of the bed level of an equilibrium meander bend
 for the case of uniform bed material

\end{lstlisting}
\subsection{grain\_size\_profile}
${}$
\begin{lstlisting}
 transverse (across channel) profile of the bed material grain size
 in a river meander

\end{lstlisting}
\section{meander-bend}
\subsection{Kinoshita}
${}$
\begin{lstlisting}
% Public properties
% Public get properties
% Private properties
% Constructor
% Setters and getters
% generic methods

\end{lstlisting}
\subsection{bend\_transverse\_velocity}
${}$
\begin{lstlisting}
 transverse profile of the streamwise velocity in a meander bend

\end{lstlisting}
\subsection{bend\_velocity\_near\_bed}
${}$
\begin{lstlisting}
 near-bed-velocity in a meander bend

\end{lstlisting}
\subsection{kinoshita\_}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{random\_meander}
${}$
\begin{lstlisting}
 generate a pseudo random meander

\end{lstlisting}
\subsection{secondary\_velocity\_profile\_ikeda}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_rozovskii}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{potential-flow/@Potential\_Flow}
\subsection{Potential\_Flow}
${}$
\begin{lstlisting}
 numerical potential flow solver by various methods
 analytic (series)
 or FDM on non-orthogonal curvilinear grids
 or FEM by unstructured meshes

\end{lstlisting}
\subsection{contour}
${}$
\begin{lstlisting}
 contour plot of the potential flow solution

\end{lstlisting}
\subsection{infer\_bed\_level}
${}$
\begin{lstlisting}
 note: this is pretty much a broken function for the inference of stationary
       morphology

 Missing:
 - rolling down of transverse slope to balance secondary flow in bends
 - quasi time steippong

 at stationary state:
 - changes of discharge along the streamlines of discharge are balanced
   by a change in depth, to keep the velocity and sediment transport constant along the streamline

 dz_b/dt = dqs/dx + dqs/dn = 0                    (i)
 TODO this only true for infinite bends, as sediment can also move to the side
 dqs/ds  = d/s(q/h) = 1/h dq/ds - q/h^2 dh/ds = 0
 TODO this is only true in an ifinite bend (ikeda)
 dqs/dn = 0
 streamlines along discharge or velocity -> does not matter eq (i) is direction independent

\end{lstlisting}
\subsection{infer\_bed\_level2}
${}$
\begin{lstlisting}
 infer the bed level

\end{lstlisting}
\subsection{infer\_bed\_level3}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{infer\_bed\_level\_loop}
${}$
\begin{lstlisting}
 the bed level does not completely converge but starts to oscillate,
 this is presumably due to the non-compact kernel implementation of the laplacian oberator

\end{lstlisting}
\subsection{objective\_bed\_level}
${}$
\begin{lstlisting}
 objective function for determining the bed level

\end{lstlisting}
\subsection{plot}
${}$
\begin{lstlisting}
 surface plot

\end{lstlisting}
\subsection{quiver}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{sediment\_transport}
${}$
\begin{lstlisting}
 compute the sediment transport

\end{lstlisting}
\subsection{solve\_potential}
${}$
\begin{lstlisting}
 solve for the potential

\end{lstlisting}
\subsection{streamline}
${}$
\begin{lstlisting}
 compute a streamline

\end{lstlisting}
\subsection{surface\_elevation}
${}$
\begin{lstlisting}
 compute surface elevation according to Bernoulli's law
 note : this is likely very different from the true surface elevation,
        as streamline curvature causes a transverse pressure gradient

\end{lstlisting}
\subsection{test\_case}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{velocity\_near\_bed}
${}$
\begin{lstlisting}

 determine the velocity near the bed

\end{lstlisting}
\subsection{vertical\_velocity}
${}$
\begin{lstlisting}
 determine the vertical velocity by continuity

\end{lstlisting}
\section{potential-flow/@Potential\_Flow\_Analytic}
\subsection{Potential\_Flow\_Analytic}
${}$
\begin{lstlisting}
 analytical solutions to various depth-averaged potential flow problems


\end{lstlisting}
\subsection{streamline}
${}$
\begin{lstlisting}
 numerically follow path along streamline by integrating the velocity

\end{lstlisting}
\section{potential-flow/@Potential\_Flow\_SM}
\subsection{Potential\_Flow\_SM}
${}$
\begin{lstlisting}
 numerical solver for flow on a curvilinear grid (not necessarilly orthogonal)
 by means of the Finite Difference Method

\end{lstlisting}
\subsection{assemble\_discretization\_matrix\_rectilinear}
${}$
\begin{lstlisting}
 assemble the discretisation matrix

\end{lstlisting}
\subsection{assemble\_potential\_matrix}
${}$
\begin{lstlisting}
 assemble the discretisation matrix for potential flow

\end{lstlisting}
\subsection{boundary\_condition\_side\_outflow}
${}$
\begin{lstlisting}
 apply boundary conditions for side outflow
 p*phi + (1-p)*d/db phi = rhs
 y : along channel coordinate
 TODO, make this return the bc-struct

\end{lstlisting}
\subsection{boundary\_condition\_side\_outflow\_1}
${}$
\begin{lstlisting}
 apply boundary conditions
 p*phi + (1-p)*d/db phi = rhs

 TODO, make this return the bc-struct


\end{lstlisting}
\subsection{cut\_boundary}
${}$
\begin{lstlisting}
 cut the boundary from the domain
 wa : width of inlet to side channel
 wb : width of side channel

\end{lstlisting}
\subsection{cut\_rectangle}
${}$
\begin{lstlisting}
 cut a rectangle from the domain
 TODO, this requires also an adaptation of the derivative matrices
       -> step over to semi-unstructured mesh

\end{lstlisting}
\section{potential-flow/@Potential\_Flow\_UM}
\subsection{Potential\_Flow\_UM}
${}$
\begin{lstlisting}
 numerical solver for flow on an unstructured mesh (triangulation)
 by means of the Finite Element Method

\end{lstlisting}
\subsection{assemble\_potential\_matrix}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{rating-curve}
\subsection{ChezyRatingCurve}
${}$
\begin{lstlisting}
 rating curve, Chezy formalism

\end{lstlisting}
\subsection{DynamicKeuleganRC}
${}$
\begin{lstlisting}
 Dynamic Rating Curve, Keulegan roughness formulation
 (dynamic = correction for hysteresis loop)

\end{lstlisting}
\subsection{DynamicManningRC}
${}$
\begin{lstlisting}
 Dynamic Rating Curve, Manning roughness formulation
 (dynamic = correction for hysteresis loop)

\end{lstlisting}
\subsection{DynamicPowerRC}
${}$
\begin{lstlisting}
 Dynamic Power Law Rating curve
 (dynamic = correction for hysteresis loop)

\end{lstlisting}
\subsection{KeuleganRatingCurve}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{ManningRatingCurve}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{PolyRatingCurve}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{PowerRatingCurve}
${}$
\begin{lstlisting}
 stationary rating curve, power law

\end{lstlisting}
\subsection{PowerRatingCurveOffset}
${}$
\begin{lstlisting}
 stationary rating curve, stage-discharge follows power law

\end{lstlisting}
\subsection{RatingCurve}
${}$
\begin{lstlisting}
 Fri Feb 13 10:02:52 CET 2015
 rating curve superclass

\end{lstlisting}
\subsection{csarea}
${}$
\begin{lstlisting}
 predict cross sectional area from transverse bed level profile
 and surface elevation

\end{lstlisting}
\subsection{csdischarge}
${}$
\begin{lstlisting}
 compute discharge

\end{lstlisting}
\subsection{csperimeter}
${}$
\begin{lstlisting}
 compute wetted perimeter

\end{lstlisting}
\subsection{csradius}
${}$
\begin{lstlisting}
 compute hydraulic radius of the cross section

\end{lstlisting}
\subsection{cswidth}
${}$
\begin{lstlisting}
 determine cross section width


\end{lstlisting}
\subsection{test\_PowerRatingCurve}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{wfunc}
${}$
\begin{lstlisting}
 determine channel width

\end{lstlisting}
\section{shallow-water/@SWE}
\subsection{SWE}
${}$
\begin{lstlisting}
 Class to solve the (cross sectionally averaged) shallow water equation
 (st venant equation)

\end{lstlisting}
\subsection{bc\_incoming\_non\_reflecting}
${}$
\begin{lstlisting}
 set non-reflecting boundary condition for the 1D SWE

\end{lstlisting}
\subsection{bc\_inflow}
${}$
\begin{lstlisting}
 inflow boundary condition

\end{lstlisting}
\subsection{bc\_inflow\_low\_pass}
${}$
\begin{lstlisting}
 set low frequency Dirichlet, high frequency pass boundary condition

\end{lstlisting}
\subsection{bc\_inflow\_non\_reflecting}
${}$
\begin{lstlisting}
 set non-reflecting boundary condition

\end{lstlisting}
\subsection{bc\_level}
${}$
\begin{lstlisting}
 set surface level as Dirichlet boundary condition

\end{lstlisting}
\subsection{bc\_level\_sommerfeld}
${}$
\begin{lstlisting}
 set surface level as boundary condition by sommerfeld method

\end{lstlisting}
\subsection{bc\_nonreflecting}
${}$
\begin{lstlisting}
 set non-reflecting boundary condition
 extrapolate 0-order

\end{lstlisting}
\subsection{bc\_reflecting}
${}$
\begin{lstlisting}
 set reflecting boundary condition
 extrapolate 0-order and invert v

\end{lstlisting}
\subsection{dot}
${}$
\begin{lstlisting}
 time derivative
 (only for matlab internal ode-solver)
 TODO this is not swe specific
 continuity
 dA/dt + dQ/dx = I
 
 momentum
 dQ/dt + d/dx( Qu + 1/2 gh^2) = gA(S_f - S_b)
 S_b = dz_b/dx
 S_f = tau_x/rho_w = C_f u|u|

\end{lstlisting}
\subsection{dt\_cfl}
${}$
\begin{lstlisting}
 determine time step required by cfl

\end{lstlisting}
\subsection{energy}
${}$
\begin{lstlisting}
 determine total energy as sump of potential and kinetic energy
 this is preserved for fricitionless flows

\end{lstlisting}
\subsection{flux}
${}$
\begin{lstlisting}
 st venant's shallow water equation fluw

\end{lstlisting}
\subsection{flux\_lin}
${}$
\begin{lstlisting}
 linearised st-venant equation

\end{lstlisting}
\subsection{fluxmateig}
${}$
\begin{lstlisting}
 eigenvalues und vectors of the swe

\end{lstlisting}
\subsection{jacobian}
${}$
\begin{lstlisting}
 Jacobian of the SWE

 dq/dt + J dq/dx = sourceterm
 note: d/dx(A*q) = J dq/dx

\end{lstlisting}
\subsection{lindot}
${}$
\begin{lstlisting}
 linearised SWE
 width variation not included, goes into rhs force term

 [      0,  1] [A]    = [    Q]
 [ -u^2+gH, 2u] [Q]_dx   [Q^2/A+1/2gA^2/w]_dx - 1/2gA^2/w^2 dw/dx
                                               force term


\end{lstlisting}
\subsection{roe\_average}
${}$
\begin{lstlisting}
 roe average for the SWE

\end{lstlisting}
\subsection{solve\_analytic}
${}$
\begin{lstlisting}
 linearised analytic solution of the swe

\end{lstlisting}
\subsection{solve\_stationary}
${}$
\begin{lstlisting}
 stationary solution to the SWE

\end{lstlisting}
\subsection{source\_bed\_level}
${}$
\begin{lstlisting}
 source term of the SWE caused by a change of the bed level

 Note: this term causes splitting and averaging methods to fail to
       give accurate predictions of the smooth surface at steps of the bed

\end{lstlisting}
\subsection{source\_friction}
${}$
\begin{lstlisting}
 friction source term of the SWE

\end{lstlisting}
\subsection{source\_width}
${}$
\begin{lstlisting}
 source term (reaction term) for channels with variable width

\end{lstlisting}
\subsection{swe\_geometry}
${}$
\begin{lstlisting}
 predefined functions to set up channel geometry

\end{lstlisting}
\subsection{swe\_ic}
${}$
\begin{lstlisting}
 predefined functions of channel geometries

\end{lstlisting}
\section{shallow-water/@SWE\_2d}
\subsection{SWE\_2d}
${}$
\begin{lstlisting}
 Dynamic solution of the shallow water equation (depth average, 2D)

\end{lstlisting}
\subsection{apply\_boundary\_condition\_stationary}
${}$
\begin{lstlisting}
 apply boundary condition for stationary flow

\end{lstlisting}
\subsection{assemble\_stationary}
${}$
\begin{lstlisting}
 TODO, g should be replaced by gx,gy,gz, see chaudhri
 assemble discretisation matrix for stationary flow

\end{lstlisting}
\subsection{solve\_stationary}
${}$
\begin{lstlisting}
 solve SWE for statinary flow (dU/dt = dQ/dt = 0)

\end{lstlisting}
\section{shallow-water}
\subsection{sw\_reflection}
${}$
\begin{lstlisting}
 reflection coefficients of shallow water waves at a sudden change of the
 cross section (sudden change of admittance)
 c.f. lighthill, ippen-harleman

\end{lstlisting}
\subsection{sw\_reflection\_stepwise}
${}$
\begin{lstlisting}
 time passes and phase shifts
 transmission and reflection coefficient depend on direction !
 iterative (recursive) reflection and transmission

\end{lstlisting}
\section{open-channel-flow}
\begin{lstlisting}
functions for open channel flow, sub modules:

@Backwater1D
	gradually varied flow in 1D (backwater)
@Potential_Flow
	depth averaged potential flow, numerical solution
@Potential_Flow_Analytic
	depth averaged potential flow, analytical solution
rating-curve
	empirical rating curves
@Side_Weir
	analytical solution to lateral outflow over a side weir
@SWE
	dynamical solution of the shallow water equation (saint-venant-equation)
	in 1D
@SWE_2d
	dynamical solution of the shallow water equation (saint-venant-equation)
	in 2D
velocity-profile
	vertical and transverse velocity profiles of the streamwise velocity


\end{lstlisting}
\subsection{stage2discharge}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{test/test\_Backwater1D}
\subsection{test\_bw1d\_solve\_matrix}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{test}
\subsection{test\_inverse\_backwater\_curve}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_normal\_flow}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{test\_nse\_nz}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{uniform-stationary-flow}
\subsection{chezy2drag}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{chezy2f}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{chezy2manning}
${}$
\begin{lstlisting}
 convert chezy to manning

\end{lstlisting}
\subsection{chezy2z0}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{critical\_flow\_depth}
${}$
\begin{lstlisting}
 critical flow depth in uniform stationary flow

\end{lstlisting}
\subsection{drag2chezy}
${}$
\begin{lstlisting}
 convert drag coefficient to chezy coefficient
 g dz_s/dx + cd w u^2/h   = 0 (swe formalism)
      - S  +  1/C^2 U^2/H = 0 (chezy formalism)

\end{lstlisting}
\subsection{f2chezy}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{ks2z0}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{manning2chezy}
${}$
\begin{lstlisting}
 manning to chezy conversion

\end{lstlisting}
\subsection{manning2drag}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{manning2kc}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{manning2z0}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{normal\_flow\_depth}
${}$
\begin{lstlisting}
 normal flow depth for uniform stationary flow
 function H = normal_flow_depth(Q,W,C,S)

\end{lstlisting}
\subsection{normal\_flow\_depth\_}
${}$
\begin{lstlisting}
 normal flow depth in uniform stationary flow

\end{lstlisting}
\subsection{normal\_flow\_discharge}
${}$
\begin{lstlisting}
 normal flow discharge for uniform stationary flow

\end{lstlisting}
\subsection{normal\_flow\_slope}
${}$
\begin{lstlisting}
 energy slope (surface slope) for uniform stationary flow
 normal flow slope in uniform stationary flow

\end{lstlisting}
\subsection{normal\_flow\_velocity}
${}$
\begin{lstlisting}
 normal flow velocity in uniform stationary flow

\end{lstlisting}
\subsection{normal\_shear\_velocity}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{shear\_velocity}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{z02chezy}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{z02ks}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{velocity-profile/@Log\_profile}
\subsection{Log\_profile}
${}$
\begin{lstlisting}
 logarithmic profile of the streamwise velocity

\end{lstlisting}
\subsection{df\_dh}
${}$
\begin{lstlisting}
 sensitivity of profile with respect to depth

\end{lstlisting}
\subsection{df\_dh\_}
${}$
\begin{lstlisting}
 sensitivity of profile with respect to depth

\end{lstlisting}
\subsection{df\_dln\_z0}
${}$
\begin{lstlisting}
 sensitivity of velocity profile with respect to roughness length

\end{lstlisting}
\subsection{df\_dln\_z0\_}
${}$
\begin{lstlisting}
 sensitivity of profile with respect to roughness length

\end{lstlisting}
\subsection{profile}
${}$
\begin{lstlisting}
 vertical profile of the streamwise velocity

\end{lstlisting}
\subsection{profile\_}
${}$
\begin{lstlisting}
 scale of velocity at instrument depth to depth average velocity
 roughness length and associated standard error can change in time,
 i.e. may be passed as vectors

 zs    : [1xn] water surface level
 zb    : [1x1] bottom level
 za    : [1xn] or [1x1]
         level of velocity measurement,
         i.e. level of HADCP beam bin centre, coincides with instrument level,
         if the HADCP is horizontally aligned
         only needs to be passed as vector if instrument is redeployed or
         becomes misaligned
 ln_z0 : [1xn] or [1x1]
         natural logarithm of the roughness length
 s     : [1xn] or [1x1]
         standard error of ln_z0
 function [fz_mu fz_s fz_sp fz_bias fz_eps] = log_profile(zs,zb,za,ln_z0,s,sp,e)

\end{lstlisting}
\subsection{profile\_bias}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{regmtx}
${}$
\begin{lstlisting}
 regression matrix

\end{lstlisting}
\subsection{ubar}
${}$
\begin{lstlisting}
 depth averaged velocity

\end{lstlisting}
\section{velocity-profile/@Log\_profile\_with\_bend\_correction}
\subsection{Log\_profile\_with\_bend\_correction}
${}$
\begin{lstlisting}
 vertical velocity profile corrected for bend flow

\end{lstlisting}
\subsection{df\_dc}
${}$
\begin{lstlisting}
 sensitivity of the velocity profile with respect to the bend correction
 parameter c

\end{lstlisting}
\subsection{df\_dc\_}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{du\_dz}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{fit}
${}$
\begin{lstlisting}
 fit the vertical velocity profile

\end{lstlisting}
\subsection{profile\_}
${}$
\begin{lstlisting}
 vertical velocity profile

\end{lstlisting}
\subsection{regmtx}
${}$
\begin{lstlisting}
 regression matrix

\end{lstlisting}
\subsection{u}
${}$
\begin{lstlisting}
 streamwise velocity

\end{lstlisting}
\subsection{u\_}
${}$
\begin{lstlisting}
 streamwise velocity

\end{lstlisting}
\section{velocity-profile/@Log\_profile\_with\_cubic\_wake}
\subsection{Log\_profile\_with\_cubic\_wake}
${}$
\begin{lstlisting}
 log profile with cubic wake

\end{lstlisting}
\subsection{df\_dc}
${}$
\begin{lstlisting}
 sensitivity of profile with respect to wave parameter

\end{lstlisting}
\subsection{df\_dc\_}
${}$
\begin{lstlisting}
 sensitivity of profile with respect to wake parameter

\end{lstlisting}
\subsection{profile\_}
${}$
\begin{lstlisting}
 vertical velocity profile

\end{lstlisting}
\subsection{regmtx}
${}$
\begin{lstlisting}
 regression matrix

\end{lstlisting}
\section{velocity-profile/@Log\_profile\_with\_dip}
\subsection{Log\_profile\_with\_dip}
${}$
\begin{lstlisting}
 Logarithmic profile with dip

\end{lstlisting}
\subsection{fit}
${}$
\begin{lstlisting}
 fit the vertical velocity profile

\end{lstlisting}
\section{velocity-profile/@Log\_profile\_with\_linear\_bend\_correction}
\subsection{Log\_profile\_with\_linear\_bend\_correction}
${}$
\begin{lstlisting}
 log profile with linear bend correction

\end{lstlisting}
\subsection{df\_dc}
${}$
\begin{lstlisting}
 sensitivity of profile with respect to wake parameter

\end{lstlisting}
\subsection{df\_dc\_}
${}$
\begin{lstlisting}
 sensitivity of velocity profile with respect to wave parameter

\end{lstlisting}
\subsection{du\_dz}
${}$
\begin{lstlisting}
 velocity shear along vertical

\end{lstlisting}
\subsection{profile\_}
${}$
\begin{lstlisting}
 velocity profile

\end{lstlisting}
\subsection{regmtx}
${}$
\begin{lstlisting}
 regression matrix

\end{lstlisting}
\section{velocity-profile/@Log\_profile\_with\_wake}
\subsection{Log\_profile\_with\_wake}
${}$
\begin{lstlisting}
 logarithmic velocity profile with wake correction
 c.f. coles

\end{lstlisting}
\subsection{df\_dc}
${}$
\begin{lstlisting}
 sensitivity of profile with respect to wake parameter

\end{lstlisting}
\subsection{df\_dc\_}
${}$
\begin{lstlisting}
 sensitivity of velocity profile with respect to wake parameter

\end{lstlisting}
\subsection{du\_dz}
${}$
\begin{lstlisting}
 velocity shear

\end{lstlisting}
\subsection{profile\_}
${}$
\begin{lstlisting}
 predict velocity profile

\end{lstlisting}
\subsection{regmtx}
${}$
\begin{lstlisting}
 log law with wake
 u = us/k ln(z) - us/k ln(z0) + us/k (2/H^2 z  - 3/H^3 z^2)

\end{lstlisting}
\section{velocity-profile/@VP}
\subsection{VP}
${}$
\begin{lstlisting}
 velocity profile

\end{lstlisting}
\subsection{process\_joint}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{process\_transverse\_profile}
${}$
\begin{lstlisting}
 process the transverse velocity profile

\end{lstlisting}
\subsection{process\_vertical\_profile}
${}$
\begin{lstlisting}
 predict vertical profile error distribution parameter for HADCP error estimate

\end{lstlisting}
\subsection{profile\_prediction\_error}
${}$
\begin{lstlisting}
 input :
 U     : [nbin x nens]
         - values for each bin (or across section) and ensemble (or reference measurement)
         this are estimates estimates of the discharge or the cross sectional averaged
         velocity from the raw values
         - the profile should be limited to the effective profiling range,
         abobj 75-100m for a 600kHz ADCP
      
 dn    : distance between HADCP bins
 width : cross section width

 objput:
       sd_n : expected standard deviation for increasing profiling range
function [s_rel s_err s_dat rho res m2 u_pred fdx] = velocity_variation(U)
 hadcp_prediction_error
 TODO take scales and unscaled velocity to do combine with harmmean estimate
 note: previus versions:
	residual was computed with respect to the predicted local velocity
	mse was not upscaled to cs, as profile was expected to cover entire cs
	finite width of cs was not considered
 parametric estimate from moments, objliers should be filtered beforehand
 Note that the median absolute deviation is not a good estimate,
 because it may excludes rare events like reverse flow of floods
 thus, the only acceptible more robust estimate would be mean absolute deviation

\end{lstlisting}
\section{velocity-profile/@Vertical\_profile}
\subsection{Vertical\_profile}
${}$
\begin{lstlisting}
 vertical profile of the streamwise velocity, superclass

\end{lstlisting}
\subsection{fit}
${}$
\begin{lstlisting}
 fit vertical velocity profile parameter

 function obj = fit(obj,U,S,h,binmask)

\end{lstlisting}
\subsection{u}
${}$
\begin{lstlisting}
 predict velocity along the vertical based on profile

\end{lstlisting}
\section{velocity-profile}
\subsection{fit\_displacement\_profile}
${}$
\begin{lstlisting}
 fit the log profile to the vertical profile of the streamwise velocity

\end{lstlisting}
\subsection{lateral\_division\_method}
${}$
\begin{lstlisting}
 transverse (across channel) profile of the streamwise velocity
 in a straight channel
 numerical solution
 the eps seems incorrect, use better stationary_1d_swe

 rho g h S - beta q^2 f / (8 h^2)   + d/dy(eps_t dq/dy) = 0
 rho g h S - beta q^2 g / (C^2 h^2) + d/dy(eps_t dq/dy) = 0

\end{lstlisting}
\subsection{test\_law\_of\_the\_wall\_fit}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{transverse\_profile\_parameter}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{transverse\_velocity\_profile}
${}$
\begin{lstlisting}
 transverse profile of the streamwise velocity
 c.f. shiono knight

\end{lstlisting}
\subsection{transverse\_velocity\_profile\_olesen}
${}$
\begin{lstlisting}
 transverse profile of the streamwise velocity in a meander bend

\end{lstlisting}
\subsection{transverse\_velocity\_profile\_rozovskii}
${}$
\begin{lstlisting}
 transversal velocity distribution in a bend
 Rososkii,
 as in the book central differences along the radius and euler forward in space
 are used, note that since the advent of the computer more advanced schemes
 could be used (see build in solvers)
 cfl condition is not explicitely checked
 Rosovsky assumes a constant water level, e.g. does not consider superelevation

 I_theta = -1/r dz/d_theta	(p. 22)
 d_theta = 1/R ds|_R
 => I_theta = -R/r dz/ds = -R/r I_0
 It : (1.32) drop of level per unit angle, identical across section

\end{lstlisting}
\subsection{transverse\_velocity\_profile\_shiono\_knight}
${}$
\begin{lstlisting}
 transverse profile of the streamwise velocity, determined analytically
 by the method of shiono and knight
 shape of velocity profile only dependent on lambda, f, H, not slope

\end{lstlisting}
\subsection{transverse\_velocity\_profile\_tidal\_channel}
${}$
\begin{lstlisting}

\end{lstlisting}
\subsection{transverse\_velocity\_profile\_with\_slope}
${}$
\begin{lstlisting}
 stationary 1D shallow water equation across a river section
 0 = - g h S0 - tau_b/rho + d/dn (nu h du/dn)
 0 = - g h S0 + g u^2/C^2 + d/dn (nu h du/dn)
 includes tranvese gradient term
 
 note that shiono/knight 1991 provide an _analytic_ solution,
 which takes the form of an expontially decaying side wall effect


\end{lstlisting}
\subsection{vertical\_profile\_of\_velocity\_vriend}
${}$
\begin{lstlisting}
 vertical profile of the streamwise velocity, method of de vriend

\end{lstlisting}
\subsection{vertical\_velocity\_profile}
${}$
\begin{lstlisting}
 vertical profile of the streamwise velocity in non-uniform flow

\end{lstlisting}
\subsection{z2s\_rational}
${}$
\begin{lstlisting}

\end{lstlisting}
\section{wrapper}
\subsection{discharge2stage}
${}$
\begin{lstlisting}
 wrapper function

\end{lstlisting}
\subsection{stage2discharge}
${}$
\begin{lstlisting}

\end{lstlisting}
\end{document}
